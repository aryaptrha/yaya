const supabase=window.supabase.createClient(supabaseUrl,supabaseKey);async function checkVisitorSession(){const visitorName=sessionStorage.getItem("visitorName");if(visitorName){return visitorName}return null}async function saveVisitorInfo(name,pageName){try{if(name.toLowerCase()==="magic word"){const modal=document.getElementById("visitor-modal");if(modal&&modal.parentNode){modal.parentNode.removeChild(modal)}window.location.href="../pages/admin.html";return true}sessionStorage.setItem("visitorName",name);const modal=document.getElementById("visitor-modal");if(modal&&modal.parentNode){modal.parentNode.removeChild(modal)}return true}catch(err){console.error("Error in saveVisitorInfo:",err);sessionStorage.setItem("visitorName",name);const modal=document.getElementById("visitor-modal");if(modal&&modal.parentNode){modal.parentNode.removeChild(modal)}return false}}function showVisitorModal(pageName){const existingName=sessionStorage.getItem("visitorName");if(existingName){console.log(`Welcome back, ${existingName}!`);return}const existingModal=document.getElementById("visitor-modal");if(existingModal&&existingModal.parentNode){existingModal.parentNode.removeChild(existingModal)}const modalHtml=`
    <div id="visitor-modal">
      <div class="visitor-modal-content">
        <h2>Welcome!</h2>
        <p>Please enter your name to continue:</p>
        <input type="text" id="visitor-name" placeholder="Your name" class="visitor-input">
        <div class="visitor-button-container">
          <button id="visitor-submit" class="visitor-button">Continue</button>
        </div>
      </div>
    </div>
  `;const modalContainer=document.createElement("div");modalContainer.innerHTML=modalHtml;document.body.appendChild(modalContainer.firstElementChild);document.getElementById("visitor-submit").addEventListener("click",async function(){const nameInput=document.getElementById("visitor-name");const visitorName=nameInput.value.trim();if(visitorName){await saveVisitorInfo(visitorName,pageName)}else{nameInput.classList.add("error");setTimeout(()=>nameInput.classList.remove("error"),500)}});document.getElementById("visitor-name").addEventListener("keypress",async function(e){if(e.key==="Enter"){const visitorName=this.value.trim();if(visitorName){await saveVisitorInfo(visitorName,pageName)}else{this.classList.add("error");setTimeout(()=>this.classList.remove("error"),500)}}})}